<policies>
    <inbound>
		<rate-limit-by-key calls="120" renewal-period="60" counter-key="@(context.Request.IpAddress)" />
        <set-header name="x-request-context-user-id" exists-action="override">
            <value>@(context.User.Id)</value>
        </set-header>
        <set-header name="x-request-context-user-email" exists-action="override">
            <value>@(context.User.Email)</value>
        </set-header>
        <set-header name="x-request-context-user-note" exists-action="override">
            <value>@(context.User.Note)</value>
        </set-header>
        <set-header name="x-request-context-user-ukprn" exists-action="override">
            <value>@{var ukprn = 0; int.TryParse(context.User.Note, out ukprn); return ukprn;}</value>
        </set-header>
        <base />
    </inbound>
    <backend>
        <base />
    </backend>
    <outbound>
        <base />
    </outbound>
    <on-error>
        <base />
    </on-error>
</policies>